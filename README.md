# Πρώτη Εργαστηριακή Άσκηση Προγραμμτισμού Διαδικτύου (ECE_ΓΚ802)

Στη σημερινή πρώτη άσκηση θα γράψουμε προγράμματα-πελάτες (client) που χρησιμοποιούν το πρωτόκολλο HTTP για να επκοινωνήσουν με έναν εξυπηρετητή (server).

Η Python παρέχει διάφορες βιβλιοθήκες για το χειρισμό του πρωτοκόλλου HTTP, μία από τις οποίες είναι η ενσωματωμένη στη βασική διανομή urllib. Στη σημερινή άσκηση θα χρησιμοποιήσουμε τη βιβλιοθήκη requests της Python. Επίσης χρήσιμη θα είναι και η βασική γνώση regular expressions με βιβλιοθήκη re (δείτε και το Regular Expression HOWTO).

### Η βιβλιοθήκη requests

Για να εγκαταστήσετε τη requests στους υπολογιστές του ΚΥΠΕΣ, τρέξτε:

```pip3 install --user  requests```

Ανοίξτε και μελετήστε την τεκμηρίωση της βιβλιοθήκης requests. Η requests είναι μια βιβλιοθήκη για την υποβολή ερωτημάτων με το πρωτόκολλο HTTP.

Η βασική λογική της βιβλιοθήκης φαίνεται στο παρακάτω αρχικό παράδειγμα: (αρχείο ex0.py) που μας επιστρέφει τον κώδικα html της σελίδας http://python.org/:


```
import requests  # εισαγωγή της βιβλιοθήκης

def more(text):
    count = 0
    for line in text.split('\n'):
        print(line)
        count += 1
        if count % 30 == 0:
            reply = input('Show more (y/n)? ')
            if reply == 'n':
                break

url = 'http://python.org/'  # προσδιορισμός του url

with requests.get(url) as response:  # το αντικείμενο response
    html = response.text
    more(html)

```


Για να δούμε τις κεφαλίδες της σελίδας που λάβαμε, αρκεί να κοιτάξουμε στο λεξικό headers στο αντικείμενο response.

### Άσκηση 1-1 (lab1-1.py):

Σε αρχείο python με όνομα lab1-1.py γράψτε κώδικα που:

1. ζητάει από τον χρήστη ένα URL,
2. πραγματοποιεί ένα αίτημα HTTP σε αυτό το URL,
3. τυπώνει τις κεφαλίδες (headers) της απόκρισης HTTP.
4. τροποποιήστε τον κώδικα ώστε να απαντάει για το URL που έδωσε ο χρήστης με τις εξής πληροφορίες:
    <ol type="a">
        <li>ποιο είναι το λογισμικό που χρησιμοποιεί ο εξυπηρετητής (ο web server) για να απαντήσει στο αίτημα;</li>
        <li>αν η σελίδα χρησιμοποιεί cookies, και αν ναι</li>
        <li>το όνομα κάθε cookie και για πόσο διάστημα θα είναι έγκυρο.</li>
    </ol>
Για να δείτε ποιες είναι οι κεφαλίδες που δίνουν τις πληροφορίες που σας χρειάζονται, ανατρέξτε στις διαφάνειες της [διάλεξης στο eclass](https://eclass.upatras.gr/modules/units/?course=EE767&id=3262) ή στην τεκμηρίωση στο [MDN Web Docs](https://developer.mozilla.org/en-US/).
### Άσκηση 1-2 (lab1-2.py):

H σελίδα https://ds.upatras.gr/ περιέχει μια φόρμα που δέχεται ένα από τα εξής στοιχεία ενός υπαλλήλου του Πανεπιστημίου: Επίθετο, email ή τηλέφωνο, και επιστρέφει όλα τα στοιχεία του. Σημείωση: η φόρμα αποστέλει τα στοιχεία με τη μέθοδο POST του πρωτοκόλλου HTTP.

Σε αρχείο python με όνομα lab1-2.py γράψτε κώδικα που:

1. ζητάει από τον χρήστη το επώνυμο ενός υπαλλήλου και τυπώνει το μέιλ του.
2. τροποποιήστε τον κώδικα ώστε να τυπώνει επίσης το τηλέφωνο (ή τα τηλέφωνα) του υπαλλήλου.
3. τροποποιήστε τον κώδικα ώστε, αν βρεθούν περισσότεροι από ένας υπάλληλοι, να τυπώνονται ολονών τα στοιχεία.

Δείτε τις οδηγίες για το πώς μπορείτε να περάσετε παραμέτρους σε αιτήματα HTTP με τη βιβλιοθήκη requests. Η βιβλιοθήκη requests θα σας επιστρέψει όλη την ιστοσελίδα της απάντησης, εσείς όμως χρειάζεστε μόνο κάποιες πληροφορίες (μέιλ και τηλέφωνα), οπότε θα χρειαστεί κάπως να εξάγετε αυτή την πληροφορία. Μπορείτε να ανατρέξετε σε regular expressions με τη βιβλιοθήκη re της python.

Συστήνεται να μην ξεκινήσετε από το stackoverflow, αλλά να από την τεκμηρίωση και το API της requests και την αντίστοιχη τεκμηρίωση για το HTTP που υπάρχει στο MDN.


##English

A number of Python libraries allow us to handle HTTP requests. We will use today the requests Python library. Basic knowledge of regular expressions with the re library will be very useful (see the Regular Expression HOWTO).

Study the requests lib documentation. requests allows us to issue HTTP requests and handle the response generated by the server.

A basic example returns the html code of the page http://python.org/:


```
import requests  # εισαγωγή της βιβλιοθήκης

def more(text):
    count = 0
    for line in text.split('\n'):
        print(line)
        count += 1
        if count % 30 == 0:
            reply = input('Show more (y/n)? ')
            if reply == 'n':
                break

url = 'http://python.org/'  # προσδιορισμός του url

with requests.get(url) as response:  # το αντικείμενο response
    html = response.text
    more(html)
```



In order to view the HTTP response headers, we can look in the headers dict of the response object.
###Excercise 1-1:

In a file with name lab1-1.py write python code using the requests library that:

1. asks for a URL and prints the HTTP response headers.
modify the code so it returns following information:
    <ol type="a">
    <li>which software is the web server using?</li>
    <li>does the web page store cookies on the client side, and if yes</li>
    <li>for how long will the cookie be valid?</li>
    </ol>

You can review the (Greek) eclass slides and the very useful MDN Web Docs.
###Excercise 1-2:

In https://ds.upatras.gr/ there is a (Greek) web form which given the Surname, E-mail or Phone of a UPatras employee, returns a page with contact information. Note that the form sends the request with the HTTP POST method.

In a file with name lab1-2.py write code which:

1. asks the user to give the Surname of an employee, then makes a request to the ds.upatras.gr page and prints the e-mail address of the employee or a message if not found.
2. modify the code so that also the phone number(s) of the employee are printed.
3. modify the code so that if more than one employees are found, the data for all of them are printed.

Make sure that the names you request are written in Greek. You can try "Αβούρης" for example to get the contact details of a single person, and "Παπα" to get the details of all employees whose name starts with those four letters.

Make sure to consult the requests documentation on on how to pass parameters with HTTP requests. You will receive the whole web page in the response and you need to somehow extract the e-mail an the phone numbers. You can use the Python regular expressions library re.

It is recommended to skip stackoverflow, and to consult the guides and API doc of the requests library as well as the relevant  HTTP documentation on MDN.
